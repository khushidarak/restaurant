<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Flipping Menu Book</title>
  <style>
    :root{
      --book-width: 920px;   /* total book width (two pages) */
      --book-height: 640px;
      --page-gap: 14px;
      --spine-width: 12px;
      --bg: #d7c9b2; /* wood-ish fallback */
      --accent: #1b1b1b;
    }
    html,body{height:100%;margin:0;font-family: 'Georgia', 'Times New Roman', serif;background:linear-gradient(#d9d1c6,#e6decf) fixed;}
    /* Wooden plank background */
    body::before{
      content:"";
      position:fixed;inset:0;
      background-image:linear-gradient(90deg, rgba(0,0,0,0.03) 1px, transparent 1px), url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAklEQVR4AewaftIAAABFSURBVGhD7cEBAQEAAAEIP6b4gEMQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwC8B0AABbkA3QAAAABJRU5ErkJggg==');
      background-size:120px 120px, 1800px 1800px;
      opacity:0.95;
      z-index:0;
    }

    .wrap{position:relative;min-height:100vh;display:flex;align-items:center;justify-content:center;z-index:1;padding:30px;}

    /* book stage */
    .book-stage{
      width:calc(var(--book-width) + 80px);
      display:flex;justify-content:center;align-items:center;gap:20px;flex-direction:column;
    }

    .book {
      width:var(--book-width);
      height:var(--book-height);
      perspective:2200px;
      position:relative;
      box-shadow:0 20px 60px rgba(0,0,0,0.4);
      display:flex;align-items:center;justify-content:center;
      background:linear-gradient(180deg,#fff8ef,#efe7db);
      padding:24px;
      box-sizing:border-box;
    }

    /* visible spread area with spine in center */
    .spread {
      position:relative;
      width:calc(100% - 40px);
      height:100%;
      display:flex;
      align-items:stretch;
      justify-content:space-between;
      background:transparent;
      overflow:visible;
      transform-style:preserve-3d;
    }

    /* each page */
    .page {
      width:calc(50% - calc(var(--page-gap)/2));
      height:100%;
      background:#fff;
      box-sizing:border-box;
      position:relative;
      overflow:hidden;
      border:6px solid rgba(255,255,255,0.95);
      box-shadow:inset 0 0 40px rgba(0,0,0,0.35);
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      overscroll-behavior: contain;
      padding-right: 10px;
      scrollbar-width: thin;
      scrollbar-color: rgba(0,0,0,0.2) transparent;
    }
    /*hide scrollbar */
    .page::-webkit-scrollbar {width: 6px;}
    .page::-webkit-scrollbar-track {background: transparent;}
    .page::-webkit-scrollbar-thumb {background-color: rgba(0,0,0,0.2) ; border-radius: 3px;}

    /* realistic spine between pages */
    .spine {
      width:var(--spine-width);
      height:92%;
      background:linear-gradient(90deg,#0f0f0f,#3b3b3b,#0f0f0f);
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      top:4%;
      z-index:50;
      border-radius:3px;
      box-shadow:0 6px 18px rgba(0,0,0,0.5);
    }

    /* page image/content */
    .page img {
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

    /* decorative inner margin (like book gutters) */
    .page-inner {
      position:absolute;inset:22px;
      overflow-y: auto;
      padding: 20px;
      box-sizing: border-box;
    }

    /* navigation arrows */
    .nav {
      position:relative;
      width:100%;
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-top:12px;
      gap:12px;
    }
    .arrow {
      width:42px;height:42px;border-radius:4px;background:rgba(255,255,255,0.85);
      display:flex;align-items:center;justify-content:center;cursor:pointer;
      box-shadow:0 4px 12px rgba(0, 0, 0, 0.3);
      user-select:none;
    }
    .arrow svg{width:18px;height:18px;fill:#222}

    /* flipping overlay element (injected by JS) */
    .flip {
      position:absolute;
      top:0;
      height:100%;
      width:50%;
      transform-style:preserve-3d;
      z-index:120;
      pointer-events:none;
    }
    .flip-face {
      position:absolute;inset:0;
      backface-visibility:hidden;
      background-size:cover;
      background-position:center;
      box-shadow: inset 0 0 80px rgba(0,0,0,0.5);
    }
    .flip-face.front{z-index:2;}
    .flip-face.back{
      transform:rotateY(180deg);
      z-index:1;
    }

    /* flip animation handled inline via transform and transition */
    .book .page-left{transform-origin:left center;}
    .book .page-right{transform-origin:right center;}

    /* responsive */
    @media (max-width:1100px){
      :root{--book-width:760px;--book-height:520px;}
    }
    @media (max-width:820px){
      :root{--book-width:680px;--book-height:470px;}
    }
    @media (max-width:520px){
      /* mobile: show single page stacked center with smaller dimensions */
      :root{--book-width:320px;--book-height:520px;}
      .spread{transform:scale(0.96)}
      .book{padding:6px}
    }

    /* subtle bottom info bar like source site */
    .info-bar{
      width:100%;
      max-width:var(--book-width);
      margin-top:14px;
      color:#303030;
      font-size:13px;
      display:flex;align-items:center;justify-content:space-between;
      gap:12px;
    }
    .page-count{color:#444}
    /* pointer zones: clicking left/right halves flips */
    .click-zone{
      position:absolute;inset:0;z-index:60;display:flex;
      pointer-events: none;
      
    }
    .click-zone > .left, .click-zone > .right{
      flex:1;
      cursor:pointer;
       pointer-events: none;
      
    }
    /* small fade over page edges so flip looks nicer */
    .page:after{
      content:"";
      position:absolute;
      inset:0;
      box-shadow:inset 0 0 60px rgba(0,0,0,0.14);
      pointer-events:none;
    }

    /* Menu-specific styles */
    .menu-page {
      font-family: 'Georgia', serif;
      color: #333;
      line-height: 1.5;
      
    }
    
    .menu-header {
      text-align: center;
      margin-bottom: 15px;
      padding-bottom: 0px;
      border-bottom: 2px solid #d4af37;
    }
    
    .menu-header h1 {
      font-size: 28px;
      color: #8B0000;
      margin-bottom: 2px;
      letter-spacing: 1px;
    }
    
    .menu-header p {
      font-style: italic;
      color: #666;
    }
    
    .menu-section {
      margin-bottom: 25px;
    }
    
    .section-title {
      font-size: 20px;
      color: #8B4513;
      margin: 20px 0 15px;
      padding-bottom: 8px;
      border-bottom: 1px dashed #d4af37;
    }
    
    .menu-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 12px;
      padding-bottom: 10px;
      border-bottom: 1px solid #f0e6d2;
    }
    
    .item-details {
      flex: 1;
    }
    
    .item-name {
      font-weight: bold;
      font-size: 16px;
      margin-bottom: 4px;
      color: #5D2906;
    }
    
    .item-description {
      font-size: 14px;
      color: #666;
    }
    
    .item-price {
      font-weight: bold;
      color: #8B0000;
      min-width: 60px;
      text-align: right;
    }
    
    .spicy {
      color: #8B0000;
      margin-left: 5px;
    }
    
    .footer-note {
      text-align: center;
      margin-top: 20px;
      font-style: italic;
      color: #777;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="book-stage">
      <div class="book" id="book">
        <div class="spread" id="spread">
          <div class="page page-left" id="leftPage">
            <div class="page-inner" id="leftInner">
              <!-- left content inserted by JS -->
            </div>
          </div>
          <div class="spine" aria-hidden="true"></div>
          <div class="page page-right" id="rightPage">
            <div class="page-inner" id="rightInner">
              <!-- right content inserted by JS -->
            </div>
          </div>
          

          <!-- click zones for quick flipping -->
          <div class="click-zone" id="clickZones" aria-hidden="true">
            <div class="left" title="Previous"></div>
            <div class="right" title="Next"></div>
          </div>
        </div>
      </div>

      <div class="nav" style="max-width:var(--book-width)">
        <div class="arrow" id="prevBtn" title="Previous (‚Üê)">
          <svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
        </div>
        <div style="flex:1;text-align:center;">
          <div class="page-count" id="pageCount">1 / 3</div>
        </div>
        <div class="arrow" id="nextBtn" title="Next (‚Üí)">
          <svg viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6z"/></svg>
        </div>
      </div>

      <div class="info-bar">
        <div>Tip: Click the right side to flip forward, left side to flip back. Use arrow keys or swipe on touch.</div>
        <div id="debug" style="color:#666;font-size:12px"></div>
      </div>
    </div>
  </div>

  <script>
    // Menu content instead of images
    const spreads = [
      {
        left: `
          <div class="menu-page">
            <div class="menu-header">
              <h1>Elaichi</h1>
              <p>Authentic Indian Cuisine </p>
            </div>
            
            <div class="menu-section">
              <h2 class="section-title">Appetizers</h2>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Vegetable Samosa <span class="spicy">üå∂Ô∏è</span></div>
                  <div class="item-description">Crispy pastry filled with spiced potatoes and peas</div>
                </div>
                <div class="item-price">‚Çπ180</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Paneer Tikka</div>
                  <div class="item-description">Cottage cheese marinated in yogurt and spices, grilled to perfection</div>
                </div>
                <div class="item-price">‚Çπ280</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Chicken Pakora</div>
                  <div class="item-description">Tender chicken pieces in chickpea batter, deep-fried until golden</div>
                </div>
                <div class="item-price">‚Çπ250</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Aloo Tikki</div>
                  <div class="item-description">Spiced potato patties served with mint chutney and tamarind sauce</div>
                </div>
                <div class="item-price">‚Çπ160</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Onion Bhaji</div>
                  <div class="item-description">Crispy onion fritters with aromatic spices</div>
                </div>
                <div class="item-price">‚Çπ150</div>
              </div>
            </div>

            <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Chicken Pakora</div>
                  <div class="item-description">Tender chicken pieces in chickpea batter, deep-fried until golden</div>
                </div>
                <div class="item-price">‚Çπ250</div>
              </div>
            
            <div class="menu-section">
              <h2 class="section-title">Soups</h2>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Mulligatawny</div>
                  <div class="item-description">Traditional lentil soup with vegetables and aromatic spices</div>
                </div>
                <div class="item-price">‚Çπ140</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Tomato Shorba</div>
                  <div class="item-description">Creamy tomato soup with ginger and cumin</div>
                </div>
                <div class="item-price">‚Çπ130</div>
              </div>
            </div>
          </div>
        `,
        right: `
          <div class="menu-page">
            <div class="menu-header">
              <h1>Signature Curries</h1>
              <p>Prepared with authentic spices and fresh ingredients</p>
            </div>
            
            <div class="menu-section">
              <h2 class="section-title">Chicken</h2>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Butter Chicken</div>
                  <div class="item-description">Tender chicken in a rich tomato and butter sauce with fenugreek</div>
                </div>
                <div class="item-price">‚Çπ380</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Chicken Tikka Masala</div>
                  <div class="item-description">Grilled chicken in a creamy tomato and onion gravy</div>
                </div>
                <div class="item-price">‚Çπ360</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Chicken Vindaloo <span class="spicy">üå∂Ô∏èüå∂Ô∏è</span></div>
                  <div class="item-description">Spicy Goan curry with vinegar, garlic and chilies</div>
                </div>
                <div class="item-price">‚Çπ390</div>
              </div>
            </div>
            
            <div class="menu-section">
              <h2 class="section-title">Lamb & Goat</h2>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Lamb Rogan Josh</div>
                  <div class="item-description">Slow-cooked lamb in a fragrant Kashmiri curry with yogurt and spices</div>
                </div>
                <div class="item-price">‚Çπ420</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Goat Curry</div>
                  <div class="item-description">Tender goat meat simmered with onions, tomatoes and traditional spices</div>
                </div>
                <div class="item-price">‚Çπ410</div>
              </div>
            </div>
            
            <div class="menu-section">
              <h2 class="section-title">Vegetarian</h2>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Chana Masala</div>
                  <div class="item-description">Chickpeas simmered in a spicy tomato and onion gravy</div>
                </div>
                <div class="item-price">‚Çπ220</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Palak Paneer</div>
                  <div class="item-description">Cottage cheese cubes in a creamy spinach sauce with garlic and ginger</div>
                </div>
                <div class="item-price">‚Çπ260</div>
              </div>
            </div>
          </div>
        `
      },
      {
        left: `
          <div class="menu-page">
            <div class="menu-header">
              <h1>Tandoori Specialties</h1>
              <p>Cooked in our traditional clay oven</p>
            </div>
            
            <div class="menu-section">
              <h2 class="section-title">Tandoori</h2>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Tandoori Chicken (Half)</div>
                  <div class="item-description">Chicken marinated in yogurt and spices, cooked in the tandoor</div>
                </div>
                <div class="item-price">‚Çπ320</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Tandoori Chicken (Full)</div>
                  <div class="item-description">Whole chicken marinated in yogurt and spices, cooked in the tandoor</div>
                </div>
                <div class="item-price">‚Çπ450</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Seekh Kebab</div>
                  <div class="item-description">Minced lamb skewers with fresh herbs and aromatic spices</div>
                </div>
                <div class="item-price">‚Çπ380</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Paneer Tikka</div>
                  <div class="item-description">Cottage cheese cubes marinated in spiced yogurt, grilled in tandoor</div>
                </div>
                <div class="item-price">‚Çπ320</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Tandoori Prawns</div>
                  <div class="item-description">Jumbo prawns marinated in ginger, garlic and tandoori spices</div>
                </div>
                <div class="item-price">‚Çπ520</div>
              </div>
            </div>
            
            <div class="menu-section">
              <h2 class="section-title">Breads</h2>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Naan</div>
                  <div class="item-description">Traditional leavened flatbread baked in tandoor</div>
                </div>
                <div class="item-price">‚Çπ60</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Garlic Naan</div>
                  <div class="item-description">Naan topped with fresh garlic and coriander</div>
                </div>
                <div class="item-price">‚Çπ80</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Roti</div>
                  <div class="item-description">Whole wheat unleavened flatbread</div>
                </div>
                <div class="item-price">‚Çπ40</div>
              </div>
            </div>
          </div>
        `,
        right: `
          <div class="menu-page">
            <div class="menu-header">
              <h1>Rice & Biryani</h1>
              <p>Basmati rice dishes prepared with aromatic spices</p>
            </div>
            
            <div class="menu-section">
              <h2 class="section-title">Biryani</h2>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Chicken Dum Biryani</div>
                  <div class="item-description">Fragrant basmati rice layered with marinated chicken and saffron</div>
                </div>
                <div class="item-price">‚Çπ360</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Vegetable Biryani</div>
                  <div class="item-description">Basmati rice with seasonal vegetables, nuts and aromatic spices</div>
                </div>
                <div class="item-price">‚Çπ280</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Lamb Biryani</div>
                  <div class="item-description">Slow-cooked lamb with fragrant rice, caramelized onions and herbs</div>
                </div>
                <div class="item-price">‚Çπ420</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Prawn Biryani</div>
                  <div class="item-description">Succulent prawns with basmati rice, curry leaves and coconut</div>
                </div>
                <div class="item-price">‚Çπ480</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Hyderabadi Biryani</div>
                  <div class="item-description">Authentic style with kachchi gosht (raw meat) and special spices</div>
                </div>
                <div class="item-price">‚Çπ450</div>
              </div>
            </div>
            
            <div class="menu-section">
              <h2 class="section-title">Rice</h2>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Steamed Basmati Rice</div>
                  <div class="item-description">Long-grain aromatic rice</div>
                </div>
                <div class="item-price">‚Çπ120</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Jeera Rice</div>
                  <div class="item-description">Basmati rice tempered with cumin seeds</div>
                </div>
                <div class="item-price">‚Çπ150</div>
              </div>
            </div>
          </div>
        `
      },
      {
        left: `
          <div class="menu-page">
            <div class="menu-header">
              <h1>Desserts</h1>
              <p>Sweet endings to your meal</p>
            </div>
            
            <div class="menu-section">
              <h2 class="section-title">Sweet Delights</h2>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Gulab Jamun</div>
                  <div class="item-description">Soft milk dumplings soaked in rose-scented sugar syrup</div>
                </div>
                <div class="item-price">‚Çπ140</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Rasmalai</div>
                  <div class="item-description">Soft cottage cheese patties in sweetened, thickened milk with saffron</div>
                </div>
                <div class="item-price">‚Çπ160</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Kheer</div>
                  <div class="item-description">Traditional rice pudding with cardamom, saffron and nuts</div>
                </div>
                <div class="item-price">‚Çπ120</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Mango Kulfi</div>
                  <div class="item-description">Indian ice cream with real mango pulp and pistachios</div>
                </div>
                <div class="item-price">‚Çπ150</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Gajar Halwa</div>
                  <div class="item-description">Slow-cooked carrot pudding with milk, nuts and cardamom</div>
                </div>
                <div class="item-price">‚Çπ130</div>
              </div>
            </div>
            
            <div class="menu-section">
              <h2 class="section-title">Beverages</h2>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Mango Lassi</div>
                  <div class="item-description">Refreshing yogurt drink with mango pulp</div>
                </div>
                <div class="item-price">‚Çπ120</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Sweet Lassi</div>
                  <div class="item-description">Traditional yogurt drink with rose water</div>
                </div>
                <div class="item-price">‚Çπ100</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Masala Chai</div>
                  <div class="item-description">Spiced Indian tea with milk</div>
                </div>
                <div class="item-price">‚Çπ80</div>
              </div>
            </div>
          </div>
        `,
        right: `
          <div class="menu-page">
            <div class="menu-header">
              <h1>Special Combos</h1>
              <p>Perfect for sharing</p>
            </div>
            
            <div class="menu-section">
              <h2 class="section-title">For Two</h2>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Vegetarian Feast</div>
                  <div class="item-description">Paneer Tikka, Chana Masala, Palak Paneer, Naan, Rice, and Dessert</div>
                </div>
                <div class="item-price">‚Çπ750</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Non-Veg Delight</div>
                  <div class="item-description">Chicken Tikka, Butter Chicken, Lamb Rogan Josh, Naan, Rice, and Dessert</div>
                </div>
                <div class="item-price">‚Çπ950</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Tandoori Platter</div>
                  <div class="item-description">Tandoori Chicken, Seekh Kebab, Paneer Tikka, Naan, and Raita</div>
                </div>
                <div class="item-price">‚Çπ850</div>
              </div>
            </div>
            
            <div class="menu-section">
              <h2 class="section-title">Lunch Specials</h2>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Vegetarian Thali</div>
                  <div class="item-description">Assorted vegetarian curries, rice, bread, raita, and dessert</div>
                </div>
                <div class="item-price">‚Çπ320</div>
              </div>
              
              <div class="menu-item">
                <div class="item-details">
                  <div class="item-name">Non-Veg Thali</div>
                  <div class="item-description">Butter Chicken, Dal, Rice, Naan, Raita, and Dessert</div>
                </div>
                <div class="item-price">‚Çπ420</div>
              </div>
            </div>
            
            <div class="footer-note">
              <p>All dishes prepared with authentic Indian spices</p>
              <p>Ask about our daily specials!</p>
            </div>
          </div>
        `
      }
    ];

    const book = document.getElementById('book');
    const leftPage = document.getElementById('leftPage');
    const rightPage = document.getElementById('rightPage');
    const leftInner = document.getElementById('leftInner');
    const rightInner = document.getElementById('rightInner');
    const pageCountEl = document.getElementById('pageCount');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const clickZones = document.getElementById('clickZones');
    let current = 0; // index into spreads (which spread is showing)

    function renderSpread(index){
      if(index < 0) index = 0;
      if(index >= spreads.length) index = spreads.length - 1;
      current = index;
      // set backgrounds for left and right page inner content
      leftInner.innerHTML = spreads[index].left;
      rightInner.innerHTML = spreads[index].right;

      pageCountEl.textContent = `${index+1} / ${spreads.length}`;
    }

    // call initially
    renderSpread(0);

    // flipping animation logic
    function flipNext(){
      if(current >= spreads.length-1) return;
      // create flip overlay anchored to right page (rotateY from 0 to -180)
      const flip = document.createElement('div');
      flip.className = 'flip';
      flip.style.right = '0';
      flip.style.left = '50%';
      flip.style.transformOrigin = 'left center';
      flip.style.width = '50%';
      flip.style.transition = 'transform 800ms cubic-bezier(.2,.9,.3,1), box-shadow 400ms';
      flip.style.transform = 'rotateY(0deg)';

      // front face: shows current right page content as background
      const front = document.createElement('div');
      front.className = 'flip-face front';
      // Create temporary element to capture right page content as image
      const tempRight = document.createElement('div');
      tempRight.innerHTML = spreads[current].right;
      tempRight.style.position = 'absolute';
      tempRight.style.top = '-9999px';
      tempRight.style.left = '-9999px';
      document.body.appendChild(tempRight);
      
      // Convert to canvas and then to data URL
      html2canvas(tempRight).then(canvas => {
        front.style.backgroundImage = `url("${canvas.toDataURL()}")`;
        document.body.removeChild(tempRight);
      }).catch(() => {
        // Fallback if html2canvas fails
        front.style.backgroundColor = '#fff8ef';
        document.body.removeChild(tempRight);
      });

      // back face: shows next left page
      const back = document.createElement('div');
      back.className = 'flip-face back';
      const tempLeft = document.createElement('div');
      tempLeft.innerHTML = spreads[current+1].left;
      tempLeft.style.position = 'absolute';
      tempLeft.style.top = '-9999px';
      tempLeft.style.left = '-9999px';
      document.body.appendChild(tempLeft);
      
      html2canvas(tempLeft).then(canvas => {
        back.style.backgroundImage = `url("${canvas.toDataURL()}")`;
        document.body.removeChild(tempLeft);
      }).catch(() => {
        back.style.backgroundColor = '#fff8ef';
        document.body.removeChild(tempLeft);
      });

      flip.appendChild(front);
      flip.appendChild(back);
      book.appendChild(flip);

      // trigger 3D rotate
      requestAnimationFrame(() => {
        flip.style.boxShadow = '-40px 0 80px rgba(0,0,0,0.45), 0 40px 80px rgba(0,0,0,0.25)';
        flip.style.transform = 'rotateY(-180deg)';
      });

      // after animation completes, update spread and remove flip overlay
      flip.addEventListener('transitionend', () => {
        renderSpread(current+1);
        flip.remove();
      }, { once: true });
    }

    function flipPrev(){
      if(current <= 0) return;
      // create flip overlay anchored to left page (rotateY from 0 to 180)
      const flip = document.createElement('div');
      flip.className = 'flip';
      flip.style.left = '0';
      flip.style.right = '50%';
      flip.style.transformOrigin = 'right center';
      flip.style.width = '50%';
      flip.style.transition = 'transform 800ms cubic-bezier(.2,.9,.3,1), box-shadow 400ms';
      flip.style.transform = 'rotateY(0deg)';

      // front face shows current left page
      const front = document.createElement('div');
      front.className = 'flip-face front';
      const tempLeft = document.createElement('div');
      tempLeft.innerHTML = spreads[current].left;
      tempLeft.style.position = 'absolute';
      tempLeft.style.top = '-9999px';
      tempLeft.style.left = '-9999px';
      document.body.appendChild(tempLeft);
      
      html2canvas(tempLeft).then(canvas => {
        front.style.backgroundImage = `url("${canvas.toDataURL()}")`;
        document.body.removeChild(tempLeft);
      }).catch(() => {
        front.style.backgroundColor = '#fff8ef';
        document.body.removeChild(tempLeft);
      });

      // back face shows previous right page
      const back = document.createElement('div');
      back.className = 'flip-face back';
      const tempRight = document.createElement('div');
      tempRight.innerHTML = spreads[current-1].right;
      tempRight.style.position = 'absolute';
      tempRight.style.top = '-9999px';
      tempRight.style.left = '-9999px';
      document.body.appendChild(tempRight);
      
      html2canvas(tempRight).then(canvas => {
        back.style.backgroundImage = `url("${canvas.toDataURL()}")`;
        document.body.removeChild(tempRight);
      }).catch(() => {
        back.style.backgroundColor = '#fff8ef';
        document.body.removeChild(tempRight);
      });

      flip.appendChild(front);
      flip.appendChild(back);
      book.appendChild(flip);

      requestAnimationFrame(() => {
        flip.style.boxShadow = '40px 0 80px rgba(0,0,0,0.45), 0 40px 80px rgba(0,0,0,0.25)';
        flip.style.transform = 'rotateY(180deg)';
      });

      flip.addEventListener('transitionend', () => {
        renderSpread(current-1);
        flip.remove();
      }, { once: true });
    }

    // Buttons and click zones
    nextBtn.addEventListener('click', flipNext);
    prevBtn.addEventListener('click', flipPrev);
    clickZones.querySelector('.right').addEventListener('click', flipNext);
    clickZones.querySelector('.left').addEventListener('click', flipPrev);

    // keyboard navigation
    window.addEventListener('keydown', (e) => {
      if(e.key === 'ArrowRight') flipNext();
      if(e.key === 'ArrowLeft') flipPrev();
    });

    // touch swipe support
    let touchStartX = null;
    book.addEventListener('touchstart', (e) => {
      if(e.touches && e.touches.length === 1) touchStartX = e.touches[0].clientX;
    });
    book.addEventListener('touchend', (e) => {
      if(touchStartX === null) return;
      const endX = (e.changedTouches && e.changedTouches[0].clientX) || touchStartX;
      const dx = endX - touchStartX;
      if(Math.abs(dx) > 40){
        if(dx < 0) flipNext();
        else flipPrev();
      }
      touchStartX = null;
    });

    // For simplicity, we'll skip preloading since we're using HTML content
    // Instead, we'll add a simple fallback for the flip animation
    
    // Add html2canvas for the flip effect
    const script = document.createElement('script');
    script.src = 'https://html2canvas.hertzen.com/dist/html2canvas.min.js';
    document.head.appendChild(script);
    
    // If html2canvas fails to load, use a simple color fallback
    script.onerror = () => {
      console.log('html2canvas failed to load, using color fallback');
      // Override flip functions to use color instead of images
      window.flipNext = function() {
        if(current >= spreads.length-1) return;
        const flip = document.createElement('div');
        flip.className = 'flip';
        flip.style.right = '0';
        flip.style.left = '50%';
        flip.style.transformOrigin = 'left center';
        flip.style.width = '50%';
        flip.style.transition = 'transform 800ms cubic-bezier(.2,.9,.3,1), box-shadow 400ms';
        flip.style.transform = 'rotateY(0deg)';
        flip.style.backgroundColor = '#fff8ef';
        
        const front = document.createElement('div');
        front.className = 'flip-face front';
        front.style.backgroundColor = '#fff8ef';
        
        const back = document.createElement('div');
        back.className = 'flip-face back';
        back.style.backgroundColor = '#fff8ef';
        
        flip.appendChild(front);
        flip.appendChild(back);
        book.appendChild(flip);
        
        requestAnimationFrame(() => {
          flip.style.boxShadow = '-40px 0 80px rgba(0,0,0,0.45), 0 40px 80px rgba(0,0,0,0.25)';
          flip.style.transform = 'rotateY(-180deg)';
        });
        
        flip.addEventListener('transitionend', () => {
          renderSpread(current+1);
          flip.remove();
        }, { once: true });
      };
      
      window.flipPrev = function() {
        if(current <= 0) return;
        const flip = document.createElement('div');
        flip.className = 'flip';
        flip.style.left = '0';
        flip.style.right = '50%';
        flip.style.transformOrigin = 'right center';
        flip.style.width = '50%';
        flip.style.transition = 'transform 800ms cubic-bezier(.2,.9,.3,1), box-shadow 400ms';
        flip.style.transform = 'rotateY(0deg)';
        flip.style.backgroundColor = '#fff8ef';
        
        const front = document.createElement('div');
        front.className = 'flip-face front';
        front.style.backgroundColor = '#fff8ef';
        
        const back = document.createElement('div');
        back.className = 'flip-face back';
        back.style.backgroundColor = '#fff8ef';
        
        flip.appendChild(front);
        flip.appendChild(back);
        book.appendChild(flip);
        
        requestAnimationFrame(() => {
          flip.style.boxShadow = '40px 0 80px rgba(0,0,0,0.45), 0 40px 80px rgba(0,0,0,0.25)';
          flip.style.transform = 'rotateY(180deg)';
        });
        
        flip.addEventListener('transitionend', () => {
          renderSpread(current-1);
          flip.remove();
        }, { once: true });
      };
    };
  </script>
</body>
</html>